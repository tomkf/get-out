<%= render 'shared/navbar' %>

<div class="container mt-3">

  <% if current_user.first_name.nil? %>
    <% name = current_user.email %>
  <% else %>
    <% name = current_user.first_name.capitalize %>
  <% end %>

  <h1 class="mb-3">Hi <%= name %>, here's all your bookings</h1>

    <% if @bookings.where({status: ['confirmed', 'payed', 'picked_up']}).length > 0 %>
    <p>Please find all your active bookings below:</p>
    <% confirmed_bookings = @bookings.where({status: ['confirmed', 'payed', 'picked_up']}) %>
    <div class="cards">
      <% confirmed_bookings.each do |booking| %>
        <%= render 'shared/booking_card', booking: booking %>
      <% end %>
    </div>
  <% end %>

  <% if @bookings.where(status: 'requested').length > 0 %>
    <br>
    <p>Please find all your requested bookings below:</p>
    <% requested_bookings = @bookings.where(status: 'requested') %>
    <div class="cards">
      <% requested_bookings.each do |booking| %>
       <%= render 'shared/booking_card', booking: booking %>
      <% end %>
    </div>
  <% end %>

  <% if @bookings.where({status: ['completed', 'returned']}).length > 0 %>
    <br>
    <p>Please find all your completed bookings below:</p>
    <% completed_bookings = @bookings.where({status: ['completed', 'returned']}) %>
    <div class="cards">
      <% completed_bookings.each do |booking| %>
        <%= render 'shared/booking_card', booking: booking %>
      <% end %>
    </div>
  <% end %>

  <% if @bookings.where(status: 'rejected').length > 0 %>
    <br>
    <p>Please find all your rejected bookings below:</p>
    <% rejected_bookings = @bookings.where(status: 'rejected') %>
    <div class="cards">
      <% rejected_bookings.each do |booking| %>
       <%= render 'shared/booking_card', booking: booking %>
      <% end %>
    </div>
  <% end %>

  <% if @bookings.where(status: 'cancelled').length > 0 %>
    <br>
    <p>Please find all your cancelled bookings below:</p>
    <% cancelled_bookings = @bookings.where(status: 'cancelled') %>
    <div class="cards">
      <% confirmed_bookings.each do |booking| %>
        <%= render 'shared/booking_card', booking: booking %>
      <% end %>
    </div>
  <% end %>

</div>


